# ISSUE-007: onProgress callbacks lack documentation on triggering context

**Severity**: Medium
**Category**: Event Obscurity
**Detected by**: obviousness-auditor
**File**: `src/agents/types.ts:54-70`

## Description

Multiple onProgress callbacks throughout the codebase (in ScannerOptions, VoterOptions, batch-runner) lack documentation about:
- WHO triggers them (which component or function)
- WHEN they fire (at what stage of execution)
- WHY they exist (their business purpose)

For example, in ScannerOptions.onProgress, it's unclear whether this fires once per file scanned, once per issue found, or at some other interval. The VoterOptions.onProgress takes issueId and completed parameters but doesn't document whether it fires before/after each vote or only on completion.

## Problematic Code

```typescript
onProgress?: (message: string) => void;
...
onProgress?: (issueId: string, completed: boolean) => void;
```

## Recommendation

Add JSDoc comments to each onProgress callback documenting: (1) Who calls it (e.g., 'Called by runScanner for each file processed'), (2) When it's called (e.g., 'Fires after completing each vote'), (3) Why it exists (e.g., 'Enables UI to display real-time progress'). Consider adding example usage in the documentation.

## Voting Summary

**Result**: 3/3 votes to approve

- **Voter 1**: Approved - "Genuine issue. After examining the implementations, the onProgress callbacks lack documentation but ARE used with specific behavior: ScannerOptions.onProgress fires during various scanning stages (file reads, searches, completion) and VoterOptions.onProgress fires before (completed=false) and after (completed=true) each issue vote. The current type definitions provide no guidance on these semantics, which creates obscurity for developers implementing progress handlers. The recommendation to add JSDoc explaining who calls them, when, and why would materially improve code comprehension without downsides."
- **Voter 2**: Approved - "This is a genuine issue. The onProgress callbacks have different signatures (ScannerOptions takes a message string, VoterOptions takes issueId and completed boolean, BatchProgress has its own structure) but none have documentation explaining when they fire, who calls them, or what triggers them. The code shows they're called at various points (scanner: per-file/per-action, voter: before/after each vote), but this isn't documented in the type definitions. Developers using these APIs would need to read implementation code to understand the callback behavior. Adding JSDoc comments as recommended would significantly improve API clarity without introducing breaking changes or unnecessary complexity. The severity of 'medium' is appropriate - it's not critical but does impact developer experience and maintainability."
- **Voter 3**: Approved - "Genuine issue. The onProgress callbacks in ScannerOptions and VoterOptions lack documentation explaining their triggering context. After examining the implementation, I can confirm: (1) ScannerOptions.onProgress is called at multiple stages during scanning (starting scan, file operations, completion, errors), (2) VoterOptions.onProgress is called before (completed=false) and after (completed=true) each issue is voted on. These details are not documented in the type definitions, increasing cognitive load for developers using these interfaces. Adding JSDoc comments as recommended would materially improve code clarity without any downsides."

---
*Generated by Rover on December 12, 2025*