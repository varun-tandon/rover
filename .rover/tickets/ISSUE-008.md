# ISSUE-008: Silent error swallowing in getNextTicketNumber

**Severity**: Medium
**Category**: Hidden Control Flow
**Detected by**: obviousness-auditor
**File**: `src/storage/tickets.ts:29-50`

## Description

The getNextTicketNumber function has a catch block that silently returns 1 on any error. This hides potential issues like permission errors, filesystem failures, or bugs in the parsing logic. A developer reading the code wouldn't immediately know that errors are being suppressed here, making debugging harder when ticket numbering goes wrong.

## Problematic Code

```typescript
try {
  const files = await readdir(ticketsDir);
  // parsing logic...
} catch {
  return 1; // Silently swallows all errors
}
```

## Recommendation

Either: (1) Log the error before returning the fallback value so issues are visible, or (2) Only catch specific expected errors (like ENOENT for missing directory) and let unexpected errors propagate. Add a comment explaining why returning 1 is safe in error cases.

## Voting Summary

**Result**: 3/3 votes to approve

- **Voter 1**: Approved - "The issue is genuine. The catch block at line 47-48 silently swallows all errors and returns 1, which could hide permission errors, filesystem failures, or parsing bugs. This makes debugging difficult. The recommendation to either log errors or only catch specific expected errors (like ENOENT) is sound and would improve code maintainability. The same pattern appears in getExistingTickets (line 201-202), showing this is a broader pattern worth addressing. Medium severity is appropriate as it won't break functionality but impacts debuggability."
- **Voter 2**: Approved - "The issue is genuine. Lines 36-49 show a try-catch that silently swallows all errors including permission errors, filesystem failures, and parsing bugs. The function also already has an early return for the missing directory case (line 32-34), so the catch block at line 47-49 is catching unexpected errors that should likely be visible. The same pattern appears in getExistingTickets (lines 195-203). Adding error logging or being more selective about caught errors would improve debuggability without breaking functionality. The severity and recommendation are appropriate."
- **Voter 3**: Approved - "The issue is genuine. Lines 36-49 show a try-catch block that silently swallows all errors when reading the tickets directory, returning 1 as fallback. This masks legitimate errors (permission issues, filesystem failures, corrupted data) and makes debugging difficult. The recommendation to either log errors or catch only specific expected errors (like ENOENT) is sound and would improve code maintainability. Similar silent error swallowing exists in getExistingTickets (lines 195-203), reinforcing this is a pattern worth addressing. Severity of medium is appropriate."

---
*Generated by Rover on December 12, 2025*